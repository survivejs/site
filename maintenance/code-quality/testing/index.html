<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="" />
    <meta
      name="keywords"
      content="" />
    <title>Testing</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.fb86b5aa88ef613a31f1.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <div><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/0114afee1d553e8e85a0cb4e790c5dc8.jpg);"></div><h1 class="post__heading">Testing</h1><div class="header-extra"><a href="https://pixabay.com/en/eyeglasses-exam-optometry-vision-679696/">skeeze (Public Domain)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/maintenance/preface/">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/maintenance/introduction/">Introduction</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/packaging/">Packaging</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/where-to-start/">Where to Start Packaging</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/anatomy/">Anatomy of a Package</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/publishing/">Publishing Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/building/">Building Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/standalone-builds/">Standalone Builds</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/code-quality/">Code Quality</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/linting/">Linting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/code-formatting/">Code Formatting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/typing/">Typing</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Testing</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/dependencies/">Dependency Management</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/infrastructure/">Infrastructure</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/processes/">Processes</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/continuous-integration/">Continuous Integration</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/automation/">Automation</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/documentation/">Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/readme/">README</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/change-log/">Change Logs</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/site/">Site</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/api/">API Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/misc/">Other Types of Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/linting/">Linting and Formatting</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/future/">Future</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/future/longevity/">Longevity</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/future/marketing/">Marketing</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/appendices/">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/appendices/monorepos/">Managing Packages Using a Monorepo</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/appendices/customizing-eslint/">Customizing ESLint</a></li></ul><div><div class="buy-container"><a href="/maintenance/introduction"><img alt="Maintenance book cover" class="sidebar-cover" src="/44f3a3a3dad86956efa57dea740c5d44.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-maintenance">Buy at Leanpub</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img alt="React book cover" class="sidebar-cover" src="/b61671d95f81496495f2587a10ddb122.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div><div class="buy-container"><a href="/webpack/foreword"><img alt="Webpack book cover" class="sidebar-cover" src="/8f86c1d07d5536454690030cd1a10b53.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></p></div></div></div><div class="chapter"><div class="post__content"><div><blockquote class="latestpost tip"><a class="latestpost-link" href="/blog/a-plus-interview/">a-plus-forms - A+ forms. Would use again - Interview with Nikolay Nemshilov</a></blockquote></div><div class="chapter-content"><p>Tests can be seen as a runnable specification that describes truths about the implementation. Automated testing is a form of risk management and reduces risks related to the project. Manual testing is the other end of the spectrum. It&#39;s also the most labor intensive and brittle option.</p>
<h2 class="header"><a class="header-anchor" href="#what-to-verify-with-testing" id="what-to-verify-with-testing"></a><span class="text">What to Verify with Testing</span><a class="header-anchor-select" href="#what-to-verify-with-testing">#</a></h2>
<p>Testing can be used to verify at least the following aspects:</p>
<ul>
<li>Do parts of the system work in isolation?</li>
<li>Do parts of the system work together?</li>
<li>Does the system perform well enough?</li>
<li>Does the old API of the system still work for the consumers?</li>
<li>Do the tests cover the system well?</li>
<li>What is the quality of the tests?</li>
<li>Does the system solve user problems?</li>
</ul>
<p>You can test both quantitative and qualitative aspects. Qualitative testing is harder as it requires a comparison point, but without tracking quality, such as performance, it&#39;s difficult to reach it. If you track how the system is being used and capture <strong>analytics</strong>, you can tell how the users experience the system.</p>
<h2 class="header"><a class="header-anchor" href="#develop-the-right-system-the-right-way" id="develop-the-right-system-the-right-way"></a><span class="text">Develop the Right System the Right Way</span><a class="header-anchor-select" href="#develop-the-right-system-the-right-way">#</a></h2>
<p>You can assert that you are building the right system if you capture enough data. A technically correct system may not be correct from the user point of view and the other way around. The same challenge exists in developer facing tools and libraries.</p>
<p>Popular projects put a lot of effort into the façade encountered by their users. This has led to techniques such as <strong>defensive coding</strong>. A good API should fail fast instead of swallowing errors while giving descriptive messages. Projects may go as far as to provide <strong>codemods</strong> which allow users to upgrade from older APIs to newer by running them.</p>
<h2 class="header"><a class="header-anchor" href="#how-much-to-test" id="how-much-to-test"></a><span class="text">How Much to Test</span><a class="header-anchor-select" href="#how-much-to-test">#</a></h2>
<p>Regardless of how much you test, manual testing may still be required, especially if you target multiple platforms. But it&#39;s a good goal to minimize the amount of it and even try to eliminate it.</p>
<p>No matter how much you test, problems may still slip through. For this reason, it&#39;s good to remember that you get what you measure. If you want performance, you should test against performance. To avoid regressions against downstream projects, you should test against them before publishing changes.</p>
<p>Tests come with a cost. Test code is the code you have to maintain. Having more tests isn&#39;t always better. Put conscious effort into maintaining good tests instead of many. Fortunately, tests allow refactoring and sometimes finding better ways to implement the desired features can simplify both the implementation and tests.</p>
<h2 class="header"><a class="header-anchor" href="#how-to-test-old-projects-without-tests" id="how-to-test-old-projects-without-tests"></a><span class="text">How to Test Old Projects Without Tests</span><a class="header-anchor-select" href="#how-to-test-old-projects-without-tests">#</a></h2>
<p>In older projects that have poor <strong>test coverage</strong>, tests can be used for exploration. <strong>Explorative testing</strong> allows you to learn how the code works by testing it. Instead of running the code and examining it, you can write tests to assert your knowledge. As you gain confidence with the way the code works, you are more willing to make changes to it as the risk of breakage becomes smaller.</p>
<p>Specific techniques, such as <strong>snapshot testing</strong> or <strong>approval testing</strong>, allow you to capture the old state of an application or a library and test against it. Having a snapshot of the state is a good starting point as then you have something instead of nothing. Capturing this state is often cheap, and the techniques can be complemented with more specific ones. They provide a baseline for more sophisticated testing.</p>
<h2 class="header"><a class="header-anchor" href="#types-of-testing" id="types-of-testing"></a><span class="text">Types of Testing</span><a class="header-anchor-select" href="#types-of-testing">#</a></h2>
<p><img src="/249f5e772e285a5c5a12490b3b662035.png" alt="Test tower" class="" width="" height="" /></p>
<p>Mike Cohn popularized <a href="https://martinfowler.com/bliki/TestPyramid.html">the concept of the test pyramid</a>. He split testing into three levels: unit, service, and user interface. The test tower adapted from his and <a href="https://github.com/ForbesLindesay/end-to-end-testing-react-applications">Forbes Lindesay&#39;s work</a> expands on the idea.</p>
<p>Each type of testing provides specific insight to the project. The following sections cover the most common techniques while also discussed a few beyond the tower.</p>
<h3 class="header"><a class="header-anchor" href="#acceptance-testing" id="acceptance-testing"></a><span class="text">Acceptance Testing</span><a class="header-anchor-select" href="#acceptance-testing">#</a></h3>
<p><strong>Acceptance testing</strong> looks at testing from the user perspective. It answers the question does the user interface configured in a certain way lead to the expected result. Tools like <a href="http://codecept.io/">CodeceptJS</a>, <a href="https://theintern.github.io/">Intern</a>, or <a href="http://www.seleniumhq.org/">Selenium</a> provide a high-level syntax that allows you to model user behaviors against the browser.</p>
<h3 class="header"><a class="header-anchor" href="#end-to-end-testing" id="end-to-end-testing"></a><span class="text">End to End Testing</span><a class="header-anchor-select" href="#end-to-end-testing">#</a></h3>
<p><strong>End to End testing</strong> (E2E) is closer to technical level than acceptance testing and tests particular use flows. For example, in an application you would test that the user can log in and log out. Or that the user can fill a form in a specific view and get expected results.</p>
<p>Tools like <a href="https://www.npmjs.com/package/puppeteer">puppeteer</a>, <a href="https://devexpress.github.io/testcafe/">TestCafé</a>, <a href="http://nightwatchjs.org/">Nightwatch.js</a> and services such as <a href="https://www.cypress.io/">cypress</a> focus exactly on this type of testing.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://ropig.com/blog/end-end-tests-dont-suck-puppeteer/">Ropig demonstrates puppeteer and its value for E2E testing in their blog post</a>.</blockquote><h3 class="header"><a class="header-anchor" href="#integration-testing" id="integration-testing"></a><span class="text">Integration Testing</span><a class="header-anchor-select" href="#integration-testing">#</a></h3>
<p><strong>Integration testing</strong> asserts that separate modules work together. You can use the same ideas as above here except this time around the scope of the system under test is larger.</p>
<h3 class="header"><a class="header-anchor" href="#unit-testing" id="unit-testing"></a><span class="text">Unit Testing</span><a class="header-anchor-select" href="#unit-testing">#</a></h3>
<p><strong>Unit testing</strong> asserts specific truths about code. Each unit should verify the single truth. You can get started by using Node <a href="https://nodejs.org/api/assert.html">assert</a>. Specialized assertion libraries have more functionality and better output but <code>assert</code> is a good starting point.</p>
<p>To have something to test, define a module:</p>
<p><strong>add.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >const</span> add <span class="token operator" >=</span> <span class="token punctuation" >(</span>a<span class="token punctuation" >,</span> b<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> a <span class="token operator" >+</span> b<span class="token punctuation" >;</span>

module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> add<span class="token punctuation" >;</span>
</code></pre>
<p>To test the code, set up a file that exercises the functionality:</p>
<p><strong>add.test.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >const</span> assert <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'assert'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> add <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'./add'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token function" >assert</span><span class="token punctuation" >(</span><span class="token function" >add</span><span class="token punctuation" >(</span><span class="token number" >1</span><span class="token punctuation" >,</span> <span class="token number" >1</span><span class="token punctuation" >)</span> <span class="token operator" >===</span> <span class="token number" >2</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>If you run <code>node ./add.test.js</code>, you shouldn&#39;t see any output. Try breaking the test or the code to get an assertion error. A good test runner can pick up the wanted tests and run them like this. <a href="https://www.npmjs.com/package/glob">globbing</a> is another way.</p>
<p>People have written a lot of good test runners and frameworks, so you don&#39;t have to do this work yourself. <a href="https://www.npmjs.com/package/jest">Jest</a>, <a href="https://www.npmjs.com/package/mocha">Mocha</a>, and <a href="https://www.npmjs.com/package/tape">tape</a> are decent starting points.</p>
<p>It&#39;s good to understand that unit tests cover functionality from the developer perspective. These small assertions can be used to define a low-level API. <strong>Test Driven Development</strong> allows you to shape the implementation as you figure out a proper specification for your API.</p>
<h3 class="header"><a class="header-anchor" href="#property-based-testing" id="property-based-testing"></a><span class="text">Property Based Testing</span><a class="header-anchor-select" href="#property-based-testing">#</a></h3>
<p><strong>Property based testing</strong> asserts specific <strong>invariants</strong> about code. For example, a sorting algorithm should return items sorted in a specific order for example. This fact is invariant and should never change.</p>
<p>When invariants as the sorting one are known, it&#39;s possible to generate tests against them. Property based testing can find issues unit testing could miss, but the invariants can be problematic to find.</p>
<p>To continue the previous example, a property based test could be used to show that <code>add</code> is a <strong>commutative</strong> operation. Commutativity means that swapping the parameters should still yield the same result so that the result of <code>a + b</code> should equal <code>b + a</code>. The idea can be modeled behind an API like this:</p>
<p><strong>add.property.test.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >const</span> assert <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'assert'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token keyword" >const</span> add <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'./add'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token comment" spellcheck="true">// Test an invariant once</span>
<span class="token function" >testProperty</span><span class="token punctuation" >(</span>
  <span class="token punctuation" >[</span>generateNumber<span class="token punctuation" >,</span> generateNumber<span class="token punctuation" >]</span><span class="token punctuation" >,</span> <span class="token comment" spellcheck="true">// Test against numbers</span>
  <span class="token punctuation" >(</span>a<span class="token punctuation" >,</span> b<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token function" >assert</span><span class="token punctuation" >(</span><span class="token function" >add</span><span class="token punctuation" >(</span>a<span class="token punctuation" >,</span> b<span class="token punctuation" >)</span> <span class="token operator" >===</span> <span class="token function" >add</span><span class="token punctuation" >(</span>b<span class="token punctuation" >,</span> a<span class="token punctuation" >)</span><span class="token punctuation" >)</span> <span class="token comment" spellcheck="true">// Commutativity</span>
<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token keyword" >function</span> <span class="token function" >testProperty</span><span class="token punctuation" >(</span>generators<span class="token punctuation" >,</span> invariant<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> invariant<span class="token punctuation" >.</span><span class="token function" >apply</span><span class="token punctuation" >(</span><span class="token keyword" >null</span><span class="token punctuation" >,</span> generators<span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>g <span class="token operator" >=</span><span class="token operator" >></span> g<span class="token punctuation" >.</span><span class="token function" >call</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >function</span> <span class="token function" >generateNumber</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> Math<span class="token punctuation" >.</span><span class="token function" >random</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >*</span> Number<span class="token punctuation" >.</span>MAX_VALUE<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>If you run the test, it should pass given <code>add</code> should be a commutative operation. The same idea can be applied to more complicated scenarios. There are a few improvements that could be made:</p>
<ul>
<li>Instead of running a single test, it&#39;s possible to run <code>testProperty</code> many times with different values. You could model this as <code>testProperties(&lt;property&gt;, timesToRun)</code>.</li>
<li>Now it generates random values without allowing the user to set the seed value. This is a limitation of JavaScript API. To keep the tests reproducible, it&#39;s a good idea to replace <code>Math.random</code> with an alternative that allows you to control the seed.</li>
<li><code>testProperty</code> and <code>generateNumber</code> should be pushed elsewhere. Given there are existing implementations for both in npm, the custom code could be replaced entirely.</li>
<li>If the <code>add</code> function contained type information, it&#39;s possible to extract that and then map the types to generators. Doing this would keep the test code slightly neater if you have multiple tests as then you would have to define the mapping between types and generators in one place while individual tests could skip the definition problem.</li>
</ul>
<p>Good property testing tools like <a href="https://jsverify.github.io/">JSVerify</a> or <a href="http://leebyron.com/testcheck-js/">testcheck-js</a> are able to shrink a failure so you can fix it. The biggest benefit of the technique it can help to discover boundary cases to repair.</p>
<h3 class="header"><a class="header-anchor" href="#static-analysis" id="static-analysis"></a><span class="text">Static Analysis</span><a class="header-anchor-select" href="#static-analysis">#</a></h3>
<p>Static analysis tools, such as ESLint or Prettier, can help to keep code consistent and push it towards right patterns. They cannot detect each problem related to these aspects but they can still help as discussed in the <a href="/maintenance/code-quality/linting/">Linting</a> and <a href="/maintenance/code-quality/code-formatting/">Code Formatting</a> chapters.</p>
<h3 class="header"><a class="header-anchor" href="#security-testing" id="security-testing"></a><span class="text">Security Testing</span><a class="header-anchor-select" href="#security-testing">#</a></h3>
<p><strong>Security testing</strong> addresses specific vulnerabilities that allow a potential attacker to breach a system. <a href="https://www.npmjs.com/package/nsp">nsp</a> is a tool that checks your project against known vulnerabilities. <a href="https://www.npmjs.com/package/eslint-plugin-security">eslint-plugin-security</a> can be used to identify potential security hotspots that need to be checked by a human.</p>
<h3 class="header"><a class="header-anchor" href="#regression-testing" id="regression-testing"></a><span class="text">Regression Testing</span><a class="header-anchor-select" href="#regression-testing">#</a></h3>
<p><strong>Regression testing</strong> makes sure the software works still the same way as before without breaking anything.</p>
<p><strong>Approval testing</strong> allows you to develop regression tests against an existing system. The idea is to store the existing system state as snapshots and use this data for testing a behavior for changes while the implementation is being refactored.</p>
<p><strong>Visual regression testing</strong> allows you to capture the user interface as an image and then compare it to a prior state to see if it has changed too much. If it has, then the failing test needs validation by a developer to make sure the result is still acceptable. Semi-automation like this is valuable especially if you have to develop against a broad range of development targets. In the past, especially web browsers have been notorious for subtle breakage.</p>
<p>Regression testing applies on API level as well. An API that has worked in the past should work the same unless the API contract changed and a new major version was released. Even in this case it may be a good idea to provide a deprecation path for users so they can update their software to the new API. This can be achieved through explicit instructions, deprecation messages, or <strong>codemods</strong> that perform the changes for the developer.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://www.npmjs.com/package/dont-break">dont-break</a> is a good example of a package meant for testing your project against downstream (dependent) projects. <a href="https://survivejs.com/blog/dont-break-interview/">Read dont-break interview with Gleb Bahmutov</a> to understand the tool better.</blockquote><h3 class="header"><a class="header-anchor" href="#performance-testing" id="performance-testing"></a><span class="text">Performance Testing</span><a class="header-anchor-select" href="#performance-testing">#</a></h3>
<p>Given you get what you measure, <strong>performance testing</strong> is valuable for performant projects. Packages like <a href="https://k6.io/">k6</a>, <a href="https://benchmarkjs.com/">Benchmark.js</a> and <a href="https://www.npmjs.com/package/matcha">matcha</a> can be helpful here. You can benchmark your implementation against competing libraries or an older version of yours.</p>
<p>Ideally, you should store the old results somewhere and keep the runtime environment the same across separate runs. If the environment varies between runs, benchmarking results aren&#39;t comparable. Assuming you are using a conventional <strong>Continuous Integration</strong> (CI) server without storing the performance data somewhere in between and cannot control the environment, you can run both the older and the current version of the system during the same run to detect performance regressions.</p>
<p>Performance testing also yields insight into different environments, and you can test against different versions of Node for example. The same point is true for other forms of testing. If possible, run tests on a CI environment to capture more information.</p>
<h3 class="header"><a class="header-anchor" href="#mutation-testing" id="mutation-testing"></a><span class="text">Mutation Testing</span><a class="header-anchor-select" href="#mutation-testing">#</a></h3>
<p><strong>Mutation testing</strong> allows you to test your tests. The idea is to introduce mutations into the code under test and see if the tests still pass. Tools like <a href="https://stryker-mutator.github.io/">Stryker</a> enable the technique for JavaScript.</p>
<h3 class="header"><a class="header-anchor" href="#package-testing" id="package-testing"></a><span class="text">Package Testing</span><a class="header-anchor-select" href="#package-testing">#</a></h3>
<p>To make sure your npm package paths (<code>main</code>, <code>module</code>, i.e.) work, you can validate your package through <a href="https://www.npmjs.com/package/pkg-ok">pkg-ok</a>.</p>
<h3 class="header"><a class="header-anchor" href="#code-coverage" id="code-coverage"></a><span class="text">Code Coverage</span><a class="header-anchor-select" href="#code-coverage">#</a></h3>
<p><strong>Code coverage</strong> tells you how much of the code is covered by tests. The technique can reveal parts of the code that aren&#39;t being tested. Those parts have unspecified behavior and as a result may contain issues. Code coverage doesn&#39;t tell anything about the quality of the tests, but it can be used to discover places to test.</p>
<p>To measure code coverage, you have to instrument the code first. You can find <a href="https://www.npmjs.com/package/istanbul">Istanbul</a> integration for many test frameworks and Jest includes it by default. <a href="https://github.com/istanbuljs/babel-plugin-istanbul">babel-plugin-istanbul</a> comes in handy if you are using Babel.</p>
<p><a href="https://codecov.io/">Codecov</a> and <a href="https://coveralls.io/">Coveralls</a> hook into the coverage data and provide a badge to include in your README. They collect coverage for every pull request and post a comment explaining how a pull request would affect project coverage as you should maintain the current coverage at a minimum and ideally improve it.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>There&#39;s a <a href="https://chrome.google.com/webstore/detail/codecov-extension/keefkhehidemnokodkdkejapdgfjmijf">Codecov extension</a> for Chrome that allows you to see code coverage through GitHub user interface.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>Especially big and popular projects, such as <a href="http://esprima.org/test/ci.html">Esprima</a>, test their work against downstream, the other projects that consume their code. Doing this allows them to uncover bugs their own test suite fails to capture.</blockquote><h3 class="header"><a class="header-anchor" href="#code-complexity" id="code-complexity"></a><span class="text">Code Complexity</span><a class="header-anchor-select" href="#code-complexity">#</a></h3>
<p>As code evolves, it tends to become more complex. Dependencies form and the code will likely end up with hot spots that are fault prone. Understanding where those spots exist allows you work where it matters. The same idea applies to performance optimization. If you know what portion of your code contributes most to performance, you know it&#39;s worth optimizing.</p>
<p>Tools like <a href="https://www.npmjs.com/package/complexity-report">complexity-report</a>, <a href="https://www.npmjs.com/package/plato">plato</a>, and <a href="https://www.npmjs.com/package/jscomplex">jscomplex</a> give this type of output. <a href="http://eslint.org/docs/rules/complexity">ESLint has specific checks for complexity</a> <a href="https://maierfelix.github.io/Iroh/">Iroh</a> performs runtime checks.</p>
<h3 class="header"><a class="header-anchor" href="#smoke-testing" id="smoke-testing"></a><span class="text">Smoke Testing</span><a class="header-anchor-select" href="#smoke-testing">#</a></h3>
<p>The idea of <em>smoke testing</em> is to verify that vital functionality works in production. The purpose of these tests is to give high level idea of whether the application might be working or not. They are light to write and can be a starting point if the codebase doesn&#39;t have any tests yet. You could for instance assert that the application runs. This can be done for example by logging in and out of the application after deployment to production.</p>
<h3 class="header"><a class="header-anchor" href="#code-size" id="code-size"></a><span class="text">Code Size</span><a class="header-anchor-select" href="#code-size">#</a></h3>
<p>The size of the code can be important especially for frontend related packages as you want to minimize the amount of code the client has to download and parse. Tools like <a href="https://www.npmjs.com/package/size-limit">size-limit</a> and <a href="https://www.npmjs.com/package/bundlesize">bundlesize</a> achieve this.</p>
<p>You can set up size-limit to fail the CI if your library accidentally grows over a certain limit.</p>
<p>To do that, install size-limit first:</p>
<pre><code class="lang-bash">npm <span class="token function" >install</span> --save-dev size-limit
</code></pre>
<p>Update a new script and a <code>size-limit</code> section to your <em>package.json</em>:</p>
<pre><code class="lang-json"><div class="leanpub-insert">
<span class="token property" >"size-limit"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span>
  <span class="token punctuation" >{</span>
    <span class="token property" >"path"</span><span class="token operator" >:</span> <span class="token string" >"index.js"</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >]</span><span class="token punctuation" >,</span>
</div>
<span class="token property" >"scripts"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
<div class="leanpub-insert">
  <span class="token property" >"size"</span><span class="token operator" >:</span> <span class="token string" >"size-limit"</span><span class="token punctuation" >,</span>
</div>
  <span class="token property" >"test"</span><span class="token operator" >:</span> <span class="token string" >"jest"</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Run <code>npm run size</code> to see the current size of your library, with all dependencies, minified and gzipped.</p>
<p>Now, set the limit: it’s recommended to add around 1 KB over the current size, so you’ll know about any size increase:</p>
<pre><code class="lang-json"><span class="token property" >"size-limit"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span>
  <span class="token punctuation" >{</span>
<div class="leanpub-insert">
    <span class="token property" >"limit"</span><span class="token operator" >:</span> <span class="token string" >"9 KB"</span><span class="token punctuation" >,</span>
</div>
    <span class="token property" >"path"</span><span class="token operator" >:</span> <span class="token string" >"index.js"</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >]</span>
</code></pre>
<p>And finally make the CI fail on size increase:</p>
<pre><code class="lang-json"><span class="token property" >"scripts"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
  <span class="token property" >"size"</span><span class="token operator" >:</span> <span class="token string" >"size-limit"</span><span class="token punctuation" >,</span>
  <span class="token property" >"test"</span><span class="token operator" >:</span> <span class="token string" >"jest"</span>
<div class="leanpub-insert">
  <span class="token property" >"posttest"</span><span class="token operator" >:</span> <span class="token string" >"size-limit"</span>
</div>
<span class="token punctuation" >}</span>
</code></pre>
<p>If the package will ever grow over 9 KB, you’ll see an error like this:</p>
<pre><code>  Package size limit has exceeded by 25.57 KB
  Package size: 34.57 KB
  Size limit:   9 KB
  With all dependencies, minified and gzipped
</code></pre><blockquote class="tip"><i class="icon-attention-circled"></i>To find out why your library is bigger than expected, run <code>npm run size -- --why</code>.</blockquote><h3 class="header"><a class="header-anchor" href="#design-by-contract" id="design-by-contract"></a><span class="text">Design by Contract</span><a class="header-anchor-select" href="#design-by-contract">#</a></h3>
<p><a href="http://wiki.c2.com/?DesignByContract">Design by Contract</a> is a technique that allows you to push invariants, preconditions, and postconditions close to the implementation. The idea can be implemented on code level, but you can also extend the language to support the idea as <a href="https://www.npmjs.com/package/babel-plugin-contracts">babel-plugin-contracts</a> does.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Testing is a complex topic worth understanding. Testing isn&#39;t about developing faster but rather developing in a sustainable way. Tests show their value especially when multiple people work on the same project. They support the development process and allow the team to move faster while avoiding breakage. And even if breakage happens, good practices improve the process to avoid the problems in the future.</p>
<p>The biggest question is what tests to write and when. It&#39;s good to remember testing is a form of risk management. Especially when prototyping, tests won&#39;t provide their maximum value since at this stage you are prepared to throw the code away. But if you are developing long term, the absence begins to cause pain as new requirements appear and the implementation has to evolve to fit the new needs.</p>
<p>You&#39;ll learn about dependency management in the next chapter.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://medium.com/powtoon-engineering/a-complete-guide-to-testing-javascript-in-2017-a217b4cd5a2a">An Overview of JavaScript Testing in 2017</a> lists current testing tools using a similar categorization.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://github.com/atinfo/awesome-test-automation/blob/master/javascript-test-automation.md">JavaScript test automation list</a> is another good source for tools.</blockquote></div><div class="social-links"><blockquote class="tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/9484144bf9f674a8b04217e6b3cdfe78.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/maintenance/code-quality/typing/">Typing</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/fb55c4d1eed80eada788f6c7dec43569.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/maintenance/code-quality/dependencies/">Dependency Management</a></div></div><blockquote class="tip"><p>This book is <a href="https://leanpub.com/survivejs-react">available through Leanpub</a>. By purchasing the book you support the development of further content.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Dependency Management" href="/maintenance/code-quality/dependencies/"><i class="icon-right-open"></i></a><a class="previous-page" title="Typing" href="/maintenance/code-quality/typing/"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a href="/">Home</a></div><div class="nav__link"><a href="/blog/">Read the blog</a></div><div class="nav__link"><a href="/maintenance/">Maintenance book</a></div><div class="nav__link"><a href="/react/">React book</a></div><div class="nav__link"><a href="/webpack/">Webpack book</a></div><div class="nav__link"><a href="/training/">Get training</a></div><div class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/a-plus-interview/">a-plus-forms - A+ forms. Would use again - Interview with Nikolay Nemshilov</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-and-maintenance/">“SurviveJS — Webpack” v2.1 and “SurviveJS — Maintenance” v0.9</a></li><li><a class="blog-teaser" href="/blog/cabbie-interview/">Cabbie - WebDriver for the masses - Interview with Forbes Lindesay</a></li><li><a class="blog-teaser" href="/blog/react-lite-interview/">react-lite - Implementation of React optimized for small size - Interview with Jade</a></li><li><a class="blog-teaser" href="/blog/react-day-berlin-interview/">React Day Berlin - Fully Packed Day of Your Favorite React Content - Interview with Robert Haritonov</a></li><li><a class="blog-teaser" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></li><li><a class="blog-teaser" href="/blog/webexpo-2017/">Experiences on WebExpo 2017</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
        docsearch({
          apiKey: '4b3ffdbff33831aa87c5b1f39889f2af',
          indexName: 'survivejs_maintenance',
          inputSelector: '#search',
          debug: false
        });
      </script></div></div>

    
  </body>
</html>
