<html lang="en"><head><title>Configuring Hot Module Replacement</title><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui"/><meta name="description" content="
Hot Module Replacement (HMR) builds on top the WDS. It enables an interface that makes it possible to swap modules live. For example, style-loader can update your CSS without forcing a refresh. As CSS is stateless by design, implementing HMR for it is ideal.

HMR is possible with JavaScript too, bu…"/><meta name="keywords" content="webpack,react,javascript,programming,web development"/><link rel="icon" type="image/png" href="/assets/img/favicon.png"/><link rel="alternate" type="application/atom+xml" href="/atom.xml"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"/><link rel="stylesheet" href="/assets/main.css"/></head><body><main role="main"><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/assets/img/chapters/inferno.jpg);"></div><h1 class="post__heading">Configuring Hot Module Replacement</h1><div class="header-extra"><a href="https://pixabay.com/en/flame-fire-inferno-orange-burn-1761916/">DanielBrachlow (Public Domain)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/foreword">Foreword</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/preface">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/introduction">Introduction</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/what-is-webpack">What is Webpack?</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/developing">Developing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/getting-started">Getting Started</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/automatic-browser-refresh">Automatic Browser Refresh</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Configuring Hot Module Replacement</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/linting">Linting JavaScript</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/composing-configuration">Composing Configuration</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/styling">Styling</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/loading">Loading Styles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/separating-css">Separating CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/autoprefixing">Autoprefixing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/eliminating-unused-css">Eliminating Unused CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/linting">Linting CSS</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/loading">Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/loader-definitions">Loader Definitions</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/images">Loading Images</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/fonts">Loading Fonts</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/javascript">Loading JavaScript</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/building">Building</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/source-maps">Source Maps</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/splitting-bundles">Splitting Bundles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/code-splitting">Code Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/tidying-up">Tidying Up</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/optimizing">Optimizing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/minifying">Minifying</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/tree-shaking">Tree Shaking</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/setting-environment-variables">Setting Environment Variables</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/adding-hashes-to-filenames">Adding Hashes to Filenames</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/separating-manifest">Separating a Manifest</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/analyzing-build-statistics">Analyzing Build Statistics</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/performance">Performance</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/output">Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/targets">Build Targets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/library-output">Library Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/multiple-pages">Multiple Pages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/server-side-rendering">Server Side Rendering</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/techniques">Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/dynamic-loading">Dynamic Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/web-workers">Web Workers</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/i18n">Internationalization</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/testing">Testing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/deploying">Deploying Applications</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/packages">Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming">Consuming Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring">Authoring Packages</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/extending">Extending</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/loaders">Extending with Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/plugins">Extending with Plugins</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/conclusion">Conclusion</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/appendices">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/comparison">Comparison of Build Tools</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/searching-with-react">Searching with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr-with-react">Hot Module Replacement with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/customizing-eslint">Customizing ESLint</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/troubleshooting">Troubleshooting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/glossary">Glossary</a></li></ul><div><div class="buy-container"><a href="/webpack/introduction"><img class="sidebar-cover" src="/assets/img/webpack_title_page_small.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img class="sidebar-cover" src="/assets/img/react_title_page_small.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div></div></div><div class="chapter"><div class="post__content"><blockquote class="latestpost tip"><div>From the blog:</div><a class="latestpost-link" href="/blog/euro-tour-2017">SurviveJS Euro Tour 2017</a></blockquote><div class="chapter-content"><p><strong>Hot Module Replacement</strong> (HMR) builds on top the WDS. It enables an interface that makes it possible to swap modules live. For example, <em>style-loader</em> can update your CSS without forcing a refresh. As CSS is stateless by design, implementing HMR for it is ideal.</p>
<p>HMR is possible with JavaScript too, but due to application state, it&#39;s harder. In the <a href="/webpack/appendices/hmr-with-react">Hot Module Replacement with React</a> appendix, you can see how to set it up with React. You can use the same idea elsewhere as well. Vue and <a href="https://www.npmjs.com/package/vue-hot-reload-api">vue-hot-reload-api</a> is a good example.</p>
<p>You could use <code>webpack-dev-server --hot</code> to achieve this from the CLI. <code>--hot</code> enables the HMR portion from webpack through a particular plugin designed for this purpose and writes an entry pointing to a JavaScript file related to it. Another option is to go through webpack configuration as that provides more flexibility.</p>
<h2 class="header"><a class="header-anchor" href="#defining-configuration-for-hmr" id="defining-configuration-for-hmr"></a><span class="text">Defining Configuration for HMR</span><a class="header-anchor-select" href="#defining-configuration-for-hmr">#</a></h2>
<p>If you set up WDS through webpack configuration, you have to attach WDS specific options to a <code>devServer</code> field and enable <code>HotModuleReplacementPlugin</code>. Also, you need to combine the new configuration with the old one so that it doesn&#39;t get applied to the production build as HMR doesn&#39;t have any value there.</p>
<p>Consider the basic setup below:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-insert">
<span class="token keyword" >const</span> webpack <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'webpack'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>


<span class="token keyword" >const</span> commonConfig <span class="token operator" >=</span> <span class="token punctuation" >{</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<div class="leanpub-insert">
<span class="token keyword" >function</span> <span class="token function" >productionConfig</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> commonConfig<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >function</span> <span class="token function" >developmentConfig</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> config <span class="token operator" >=</span> <span class="token punctuation" >{</span>
    devServer<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token comment" spellcheck="true">// Enable history API fallback so HTML5 History API based</span>
      <span class="token comment" spellcheck="true">// routing works. This is a good default that comes</span>
      <span class="token comment" spellcheck="true">// in handy in more complicated setups.</span>
      historyApiFallback<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>

      <span class="token comment" spellcheck="true">// Don't refresh if hot loading fails. If you want</span>
      <span class="token comment" spellcheck="true">// refresh behavior, set hot: true instead.</span>
      hotOnly<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>

      <span class="token comment" spellcheck="true">// Display only errors to reduce the amount of output.</span>
      stats<span class="token punctuation" >:</span> <span class="token string" >'errors-only'</span><span class="token punctuation" >,</span>

      <span class="token comment" spellcheck="true">// Parse host and port from env to allow customization.</span>
      <span class="token comment" spellcheck="true">//</span>
      <span class="token comment" spellcheck="true">// If you use Docker, Vagrant or Cloud9, set</span>
      <span class="token comment" spellcheck="true">// host: options.host || '0.0.0.0';</span>
      <span class="token comment" spellcheck="true">//</span>
      <span class="token comment" spellcheck="true">// 0.0.0.0 is available to all network devices</span>
      <span class="token comment" spellcheck="true">// unlike default `localhost`.</span>
      host<span class="token punctuation" >:</span> process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>HOST<span class="token punctuation" >,</span> <span class="token comment" spellcheck="true">// Defaults to `localhost`</span>
      port<span class="token punctuation" >:</span> process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>PORT<span class="token punctuation" >,</span> <span class="token comment" spellcheck="true">// Defaults to 8080</span>

      <span class="token comment" spellcheck="true">// Enable error/warning overlay</span>
      overlay<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
        errors<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>
        warnings<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
      <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>HotModuleReplacementPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >;</span>

  <span class="token keyword" >return</span> Object<span class="token punctuation" >.</span><span class="token function" >assign</span><span class="token punctuation" >(</span>
    <span class="token punctuation" >{</span><span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    commonConfig<span class="token punctuation" >,</span>
    config<span class="token punctuation" >,</span>
    <span class="token punctuation" >{</span>
      plugins<span class="token punctuation" >:</span> commonConfig<span class="token punctuation" >.</span>plugins<span class="token punctuation" >.</span><span class="token function" >concat</span><span class="token punctuation" >(</span>config<span class="token punctuation" >.</span>plugins<span class="token punctuation" >)</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</div>

module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span>env<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
  console<span class="token punctuation" >.</span><span class="token function" >log</span><span class="token punctuation" >(</span><span class="token string" >'env'</span><span class="token punctuation" >,</span> env<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  <span class="token keyword" >return</span> commonConfig<span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
  <span class="token keyword" >if</span> <span class="token punctuation" >(</span>env <span class="token operator" >===</span> <span class="token string" >'production'</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token function" >productionConfig</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>

  <span class="token keyword" >return</span> <span class="token function" >developmentConfig</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>It&#39;s plenty of code. Especially the <code>Object.assign</code> portion looks knotty. That is fixed in the <em>Splitting Configuration</em> chapter soon enough.</p>
<p>Execute <code>npm start</code> and surf to <code>http://localhost:8080</code>. Try modifying <em>app/component.js</em>. Note how it fails to refresh.</p>
<p><img src="/webpack/images/no-refresh.png" alt="No refresh"></p>
<p>You see this behavior because you set <code>hotOnly: true</code> for WDS. Going with <code>inline: true</code> would have swallowed the error and refreshed the page. This behavior is okay, though, as the HMR interface is implemented next to avoid the need for the hard refresh. Before that, something can be done about those cryptic numbers to get more sensible output.</p>
<p>You can access the application alternately through <code>http://localhost:8080/webpack-dev-server/</code> instead of the root. It provides status information at the top of the application. If your application relies on WebSockets and you use WDS proxying, you need to use this particular url: otherwise, WDS logic interferes.</p>
<blockquote class="warning"><i class="icon-attention"></i><em>webpack-dev-server</em> can be picky about paths. If the given <code>include</code> paths don&#39;t match the system casing precisely, this can cause it to fail to work. Webpack <a href="https://github.com/webpack/webpack/issues/675">issue #675</a> discusses the problem in more detail.</blockquote><blockquote class="warning"><i class="icon-attention"></i>You should <strong>not</strong> enable HMR for your production configuration. It likely works, but it makes your bundles bigger than they should be.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://www.npmjs.com/package/dotenv">dotenv</a> allows you to define environment variables through a <em>.env</em> file. <em>dotenv</em> allows you to control the host and port setting of the setup quickly.</blockquote><h2 class="header"><a class="header-anchor" href="#making-the-module-ids-more-debuggable" id="making-the-module-ids-more-debuggable"></a><span class="text">Making the Module Ids More Debuggable</span><a class="header-anchor-select" href="#making-the-module-ids-more-debuggable">#</a></h2>
<p>When webpack generates a bundle, it needs to tell different modules apart. By default, it uses numbers for this purpose. The problem is that this makes it difficult to debug the code if you must inspect the resulting code. It can also lead to issues with hashing behavior.</p>
<p>To overcome this problem, it is a good idea to use an alternative module ID scheme. As it happens, webpack provides a plugin that&#39;s ideal for debugging. This plugin, <code>NamedModulesPlugin</code>, emits module paths over numeric IDs to make the output easier to understand.</p>
<p>You can enable this better behavior as follows:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >function</span> <span class="token function" >developmentConfig</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> config <span class="token operator" >=</span> <span class="token punctuation" >{</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
    plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
      <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>HotModuleReplacementPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
<div class="leanpub-insert">
      <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>NamedModulesPlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
</div>
    <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >;</span>

  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>If you restart the development server (terminate it and run <code>npm start</code>), you should see something more familiar:</p>
<p><img src="/webpack/images/no-refresh2.png" alt="No refresh, but better output"></p>
<p>The message tells that even though the HMR interface notified the client portion of the code of a hot update, nothing was done about it. This is something to fix next.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>The same idea works for production usage as you see in the <a href="/webpack/optimizing/adding-hashes-to-filenames">Adding Hashes to Filenames</a> chapter.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>A similar effect can be achieved by setting <code>output.pathInfo = true</code>. It still uses number based indices while emitting the path to the module within a comment. This should be used for development purposes only.</blockquote><h2 class="header"><a class="header-anchor" href="#implementing-the-hmr-interface" id="implementing-the-hmr-interface"></a><span class="text">Implementing the HMR Interface</span><a class="header-anchor-select" href="#implementing-the-hmr-interface">#</a></h2>
<p>Webpack exposes the HMR interface through a global, <code>module.hot</code>. It provides updates through <code>module.hot.accept(&lt;path to watch&gt;, &lt;handler&gt;)</code> function and you need to patch the application there. In this case, it is enough to replace the old DOM node with a newer one as you receive updates.</p>
<p>The following implementation illustrates the idea:</p>
<p><strong>app/index.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> component <span class="token keyword" >from</span> <span class="token string" >'./component'</span><span class="token punctuation" >;</span>

<div class="leanpub-delete">
document<span class="token punctuation" >.</span>body<span class="token punctuation" >.</span><span class="token function" >appendChild</span><span class="token punctuation" >(</span><span class="token function" >component</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</div>
<div class="leanpub-insert">
<span class="token keyword" >let</span> demoComponent <span class="token operator" >=</span> <span class="token function" >component</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

document<span class="token punctuation" >.</span>body<span class="token punctuation" >.</span><span class="token function" >appendChild</span><span class="token punctuation" >(</span>demoComponent<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token comment" spellcheck="true">// HMR interface</span>
<span class="token keyword" >if</span><span class="token punctuation" >(</span>module<span class="token punctuation" >.</span>hot<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token comment" spellcheck="true">// Capture hot update</span>
  module<span class="token punctuation" >.</span>hot<span class="token punctuation" >.</span><span class="token function" >accept</span><span class="token punctuation" >(</span><span class="token string" >'./component'</span><span class="token punctuation" >,</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
    <span class="token keyword" >const</span> nextComponent <span class="token operator" >=</span> <span class="token function" >component</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token comment" spellcheck="true">// Replace old content with the hot loaded one</span>
    document<span class="token punctuation" >.</span>body<span class="token punctuation" >.</span><span class="token function" >replaceChild</span><span class="token punctuation" >(</span>nextComponent<span class="token punctuation" >,</span> demoComponent<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    demoComponent <span class="token operator" >=</span> nextComponent<span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</div>
</code></pre>
<p>If you refresh the browser, try to modify <em>app/component.js</em> after this change, and alter the text to something else, you should notice that the browser does not refresh at all. Instead, it should replace the DOM node while retaining the rest of the application as is. The image below shows possible output.</p>
<p><img src="/webpack/images/hmr.png" alt="Patched a module successfully through HMR"></p>
<p>The idea is the same with styling, React, Redux, and other technologies. Sometimes you don&#39;t have to implement the interface yourself even as available tooling takes care of that for you.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>That <code>if(module.hot)</code> block is eliminated entirely from the production build as minifier picks it up. The <a href="/webpack/optimizing/minifying">Minifying</a> chapter delves deeper into this topic.</blockquote><h2 class="header"><a class="header-anchor" href="#hmr-on-windows-ubuntu-and-vagrant" id="hmr-on-windows-ubuntu-and-vagrant"></a><span class="text">HMR on Windows, Ubuntu, and Vagrant</span><a class="header-anchor-select" href="#hmr-on-windows-ubuntu-and-vagrant">#</a></h2>
<p>The setup can be problematic on older versions of Windows, Ubuntu, and Vagrant. You can solve this through polling:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript"><span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<span class="token keyword" >function</span> <span class="token function" >developmentConfig</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> config <span class="token operator" >=</span> <span class="token punctuation" >{</span>
    devServer<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>

<div class="leanpub-insert">
      watchOptions<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
        <span class="token comment" spellcheck="true">// Delay the rebuild after the first change</span>
        aggregateTimeout<span class="token punctuation" >:</span> <span class="token number" >300</span><span class="token punctuation" >,</span>

        <span class="token comment" spellcheck="true">// Poll using interval (in ms, accepts boolean too)</span>
        poll<span class="token punctuation" >:</span> <span class="token number" >1000</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</div>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    plugins<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
      <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-insert">
      <span class="token comment" spellcheck="true">// Ignore node_modules so CPU usage with poll</span>
      <span class="token comment" spellcheck="true">// watching drops significantly.</span>
      <span class="token keyword" >new</span> <span class="token class-name" >webpack<span class="token punctuation" >.</span>WatchIgnorePlugin</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span>
        path<span class="token punctuation" >.</span><span class="token function" >join</span><span class="token punctuation" >(</span>__dirname<span class="token punctuation" >,</span> <span class="token string" >'node_modules'</span><span class="token punctuation" >)</span>
      <span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
</div>
    <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >;</span>

  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Given this setup polls the file system, it is more resource intensive. It&#39;s worth giving a go if the default doesn&#39;t work, though.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>There are more details in <em>webpack-dev-server</em> issue <a href="https://github.com/webpack/webpack-dev-server/issues/155">#155</a>.</blockquote><h2 class="header"><a class="header-anchor" href="#setting-wds-entry-points-manually" id="setting-wds-entry-points-manually"></a><span class="text">Setting WDS Entry Points Manually</span><a class="header-anchor-select" href="#setting-wds-entry-points-manually">#</a></h2>
<p>In the setup above, the WDS-related entries were injected automatically. Assuming you are using WDS through Node, you would have to set them yourself as the Node API doesn&#39;t support injecting. The example below illustrates how to achieve this:</p>
<pre><code class="lang-javascript">entry<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
  hmr<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
    <span class="token comment" spellcheck="true">// Include the client code.</span>
    <span class="token comment" spellcheck="true">// Note how the host/port setting maps here.</span>
    <span class="token string" >'webpack-dev-server/client?http://localhost:8080'</span><span class="token punctuation" >,</span>

    <span class="token comment" spellcheck="true">// Hot reload only when compiled successfully</span>
    <span class="token string" >'webpack/hot/only-dev-server'</span><span class="token punctuation" >,</span>

    <span class="token comment" spellcheck="true">// Alternative with refresh on failure</span>
    <span class="token comment" spellcheck="true">// 'webpack/hot/dev-server',</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token comment" spellcheck="true">// The rest of the entries</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<h2 class="header"><a class="header-anchor" href="#other-features-of-webpack-dev-server-" id="other-features-of-webpack-dev-server-"></a><span class="text">Other Features of <em>webpack-dev-server</em></span><a class="header-anchor-select" href="#other-features-of-webpack-dev-server-">#</a></h2>
<p>WDS provides functionality beyond what was covered above. There are a couple of relevant fields that you should be aware of:</p>
<ul>
<li><code>devServer.contentBase</code> - Assuming you don&#39;t generate <em>index.html</em> dynamically like in this setup and rather prefer to maintain it yourself in a specific directory, you need to point WDS to it. <code>contentBase</code> accepts either a path (e.g., <code>&#39;build&#39;</code>) or an array of paths (e.g., <code>[&#39;build&#39;, &#39;images&#39;]</code>). The default for this value is the project root.</li>
<li><code>devServer.proxy</code> - If you are using multiple servers, you have to proxy WDS to them. The proxy setting accepts an object of proxy mappings (e.g., <code>{ &#39;/api&#39;: &#39;http://localhost:3000/api&#39; }</code>) that allow WDS to resolve matching queries to another server. Proxy settings are disabled by default.</li>
<li><code>devServer.headers</code> - If you want to attach custom headers to your requests, this is the place to do it.</li>
</ul>
<blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://webpack.js.org/configuration/dev-server/">The official documentation</a> covers more options.</blockquote><h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>HMR is one of those aspects of webpack that makes it attractive for developers. Even though other tools have similar functionality, webpack has taken its implementation far.</p>
<p>To recap:</p>
<ul>
<li>To work, HMR requires both client and server side support. For this purpose, webpack-dev-server provides both. Often you have to implement the client side interface although loaders like <em>style-loader</em> implement it for you.</li>
<li>It is a good idea to use the <code>NamedModulesPlugin</code> during development as that gives you better debug information.</li>
<li>The default HMR setup can be problematic on certain systems. For this reason, more resource intensive polling is an option.</li>
<li>WDS does far more than refreshing and HMR. For example proxying allows you to connect it to other servers.</li>
</ul>
<p>In the next chapter, you make it harder to make mistakes by introducing JavaScript linting to the project.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>The <a href="/webpack/appendices/hmr-with-react">Hot Module Replacement with React</a> appendix discusses HMR specifics related to React.</blockquote></div><div class="social-links"><blockquote class="tip">If you enjoyed this chapter, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/assets/img/chapters/splash.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack/developing/automatic-browser-refresh">Automatic Browser Refresh</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/assets/img/chapters/lint.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack/developing/linting">Linting JavaScript</a></div></div><blockquote class="tip"><p>This book is <a href="https://leanpub.com/survivejs-webpack">available through Leanpub</a>. By purchasing the book you support the development of further content. A part of profit (~30%) goes to Tobias Koppers, the author of Webpack.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Linting JavaScript" href="/webpack/developing/linting"><i class="icon-right-open"></i></a><a class="previous-page" title="Automatic Browser Refresh" href="/webpack/developing/automatic-browser-refresh"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a class="" href="/">Home</a></div><div class="nav__link"><a class="" href="/blog">Read the blog</a></div><div class="nav__link"><a class="" href="https://leanpub.com/survivejs-webpack">Buy the ebook</a></div><div class="nav__link"><a class="" href=""></a></div><div class="nav__link"><a class="" href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><a href="https://github.com/survivejs/webpack" class="github-corner"><svg width="80" height="80" viewBox="0 0 250 250" style="position:absolute;top:0;fill:#000;right:0;"><path class="octo-banner" d="M0 0l115 115h15l12 27 108 108V0z" fill="#fff"></path><path class="octo-arm" d="M128 109c-15-9-9-19-9-19 3-7 2-11 2-11-1-7 3-2 3-2 4 5 2 11 2 11-3 10 5 15 9 16" style="-webkit-transform-origin:130px 106px;transform-origin:130px 106px;"></path><path class="octo-body" d="M115 115s4 2 5 0l14-14c3-2 6-3 8-3-8-11-15-24 2-41 5-5 10-7 16-7 1-2 3-7 12-11 0 0 5 3 7 16 4 2 8 5 12 9s7 8 9 12c14 3 17 7 17 7-4 8-9 11-11 11 0 6-2 11-7 16-16 16-30 10-41 2 0 3-1 7-5 11l-12 11c-1 1 1 5 1 5z"></path></svg></a><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank">GitHub</a></li><li><a href="/atom.xml" target="_blank">Blog RSS</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/euro-tour-2017">SurviveJS Euro Tour 2017</a></li><li><a class="blog-teaser" href="/blog/code-quality-interview">Code Quality - Interview with João Caxaria</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-19">SurviveJS - Webpack - v1.9</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-18">SurviveJS - Webpack - v1.8</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-170">SurviveJS - Webpack - v1.7.0</a></li><li><a class="blog-teaser" href="/blog/unexpected-interview">Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen</a></li><li><a class="blog-teaser" href="/blog/ajv-interview">ajv - The Fastest JSON Schema Validator - Interview with Evgeny Poberezkin</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-160">SurviveJS - Webpack - v1.6.0</a></li><li><a class="blog-teaser" href="/blog/isomorphic-webpack-interview">isomorphic-webpack - Universal module consumption using webpack - Interview with Gajus Kuizinas</a></li><li><a class="blog-teaser" href="/blog/survivejs-webpack-150">SurviveJS - Webpack - v1.5.0</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
            ((window.gitter = {}).chat = {}).options = {
              showChatByDefault: false,
              activationElement: '.gitter-open-chat-button',
              room: 'survivejs/webpack'
            };
          </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
            docsearch({
              apiKey: '1182e3806d62e921613b8dc9c7a22ef3',
              indexName: 'survivejs_webpack',
              inputSelector: '#search',
              debug: false
            });
          </script></div></main></body></html>